<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="I.A.Wilds" />


<title>presentation 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.49.4/plotly-latest.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">I.A.Wilds Simple Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li>
  <a href="about.html">About Me</a>
</li>
<li>
  <a href="Wilds_Ivory_Presentation_1.html">Case Study 1</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">presentation 1</h1>
<h4 class="author">I.A.Wilds</h4>
<h4 class="date">1/14/2020</h4>

</div>


<pre><code>                                                  Introduction
                                                  </code></pre>
<p>Using the Beers and Breweries datasets, I have managed to gather a series of useful facts that may be used to increase prodcut sales. Larger and more complete datasets should be obtained in the future to improve upon the models and methods used below to increase sales and modeling efficiency. Data science can serve as a powerful tool for evaluting the true status of existing trends while preparing companies to perfect existing business models. The purpose of each individual code chunk has been written in complete sentences as comment above and in some cases below the respective code.</p>
<pre class="r"><code>library(ggplot2)
library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(tidyr)
library(datasets)
library(class)
library(caret)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre class="r"><code>library(jsonlite)
library(e1071)
library(rmarkdown)
library(maps)
library(sf)</code></pre>
<pre><code>## Linking to GEOS 3.6.1, GDAL 2.2.3, PROJ 4.9.3</code></pre>
<pre class="r"><code>library(ggthemes)
library(psych)</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre class="r"><code>library(usmap)
library(hrbrthemes)</code></pre>
<pre><code>## Registering Windows fonts with R</code></pre>
<pre><code>## NOTE: Either Arial Narrow or Roboto Condensed fonts are required to use these themes.</code></pre>
<pre><code>##       Please use hrbrthemes::import_roboto_condensed() to install Roboto Condensed and</code></pre>
<pre><code>##       if Arial Narrow is not on your system, please see http://bit.ly/arialnarrow</code></pre>
<pre class="r"><code>library(viridis)</code></pre>
<pre><code>## Loading required package: viridisLite</code></pre>
<pre class="r"><code>library(mapdata)
library(stringr)</code></pre>
<p>The two CSVs are read into the R scipt for use.</p>
<pre class="r"><code>beers &lt;- read.csv(&quot;C:/Users/THEBU/Desktop/Doing Data Science/Week 8/beers.csv&quot;, header = TRUE, na.strings = &quot;NA&quot;)
breweries &lt;- read.csv(&quot;C:/Users/THEBU/Desktop/Doing Data Science/Week 8/breweries.csv&quot;,header = TRUE, na.strings = &quot;NA&quot;)</code></pre>
<p>Question 1 How many breweries are present in each state? Creating a table which lists each state provides the number of breweries that are located there. Alaska, for example, has 7 breweries.</p>
<p>I decided to create a dataframe using the table. From their, I renamed the column which held the abbreviated State name and then found a listing that I could use to replace the abbreviations with the full State name. Using the map_data function, I merged the new dataframe to allow for the creation of a US map. Following the merge, I used geom_polygon with coord_map to create a simple US map.</p>
<pre class="r"><code>brewtable &lt;- table(breweries$State)
brewtabledf &lt;- as.data.frame(brewtable)
names(brewtabledf)[1] = &quot;region&quot;


st.codes&lt;-data.frame(
                      state=as.factor(c(&quot;AK&quot;, &quot;AL&quot;, &quot;AR&quot;, &quot;AZ&quot;, &quot;CA&quot;, &quot;CO&quot;, &quot;CT&quot;, &quot;DC&quot;, &quot;DE&quot;, &quot;FL&quot;, &quot;GA&quot;,
                                         &quot;HI&quot;, &quot;IA&quot;, &quot;ID&quot;, &quot;IL&quot;, &quot;IN&quot;, &quot;KS&quot;, &quot;KY&quot;, &quot;LA&quot;, &quot;MA&quot;, &quot;MD&quot;, &quot;ME&quot;,
                                         &quot;MI&quot;, &quot;MN&quot;, &quot;MO&quot;, &quot;MS&quot;,  &quot;MT&quot;, &quot;NC&quot;, &quot;ND&quot;, &quot;NE&quot;, &quot;NH&quot;, &quot;NJ&quot;, &quot;NM&quot;,
                                         &quot;NV&quot;, &quot;NY&quot;, &quot;OH&quot;, &quot;OK&quot;, &quot;OR&quot;, &quot;PA&quot;, &quot;RI&quot;, &quot;SC&quot;, &quot;SD&quot;, &quot;TN&quot;,
                                         &quot;TX&quot;, &quot;UT&quot;, &quot;VA&quot;, &quot;VT&quot;, &quot;WA&quot;, &quot;WI&quot;, &quot;WV&quot;, &quot;WY&quot;)),
                      full=as.factor(c(&quot;alaska&quot;,&quot;alabama&quot;,&quot;arkansas&quot;,&quot;arizona&quot;,&quot;california&quot;,&quot;colorado&quot;,
                                       &quot;connecticut&quot;,&quot;district of columbia&quot;,&quot;delaware&quot;,&quot;florida&quot;,&quot;georgia&quot;,
                                       &quot;hawaii&quot;,&quot;iowa&quot;,&quot;idaho&quot;,&quot;illinois&quot;,&quot;indiana&quot;,&quot;kansas&quot;,&quot;kentucky&quot;,
                                       &quot;louisiana&quot;,&quot;massachusetts&quot;,&quot;maryland&quot;,&quot;maine&quot;,&quot;michigan&quot;,&quot;minnesota&quot;,
                                       &quot;missouri&quot;,&quot;mississippi&quot;,&quot;montana&quot;,&quot;north carolina&quot;,&quot;north dakota&quot;,
                                       &quot;nebraska&quot;,&quot;new hampshire&quot;,&quot;new jersey&quot;,&quot;new mexico&quot;,&quot;nevada&quot;,
                                       &quot;new york&quot;,&quot;ohio&quot;,&quot;oklahoma&quot;,&quot;oregon&quot;,&quot;pennsylvania&quot;,&quot;rhode island&quot;,
                                       &quot;south carolina&quot;,&quot;south dakota&quot;,&quot;tennessee&quot;,&quot;texas&quot;,
                                       &quot;utah&quot;,&quot;virginia&quot;,&quot;vermont&quot;,&quot;washington&quot;,&quot;wisconsin&quot;,
                                       &quot;west virginia&quot;,&quot;wyoming&quot;))
                       )

brewtabledf[,1] &lt;- st.codes[,2]


all_states &lt;- map_data(&quot;state&quot;)

brewmap &lt;- merge(all_states,brewtabledf,by=&quot;region&quot;,all.x = T)

brewmap &lt;- brewmap[order(brewmap$order),]
mapbrew &lt;- ggplot(brewmap, aes(x=long,y=lat,group=group))+
  geom_polygon(aes(fill=Freq))+
  geom_path()+ 
  scale_fill_gradientn(colours=rev(heat.colors(10)),na.value=&quot;grey90&quot;)+
  coord_map() +
  labs(color = &quot;County flipped to ... &quot;,
  x = &quot;Latitude&quot;,
  y = &quot;Longitude&quot;,
  title = &quot;US Brewery Heat Map&quot;,
  caption = &quot;Map showing the density of breweries by State.&quot;)
mapbrew</code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code> Question 2
 Merge beer data with the breweries data after creating a single name for brew ID
 Below, the two datasets (Breweries and Beers) are merged using Brew ID as a similar factor.


```r
colnames(beers)[5] &lt;- &quot;Brew_ID&quot;
beermerge &lt;- merge(beers,breweries, all = TRUE)</code></pre>
<p>Question 2 cont. Print the first 6 observations and the last six observations to check the merged file. this does not need to be included in the presentation or the deck.) The below code will grab the first/last 6 observations using the “n” variable to dictate the number to return The head command is used for the first 6 and the tail command is used for the last 6.</p>
<pre class="r"><code>head(beermerge,n=6)</code></pre>
<pre><code>##                         Name Brew_ID Beer_ID   ABV IBU                      Style Ounces City State
## 1    #001 Golden Amber Lager     212    2149 0.055  NA American Amber / Red Lager     12 &lt;NA&gt;  &lt;NA&gt;
## 2       #002 American I.P.A.     212    2148 0.071  60               American IPA     12 &lt;NA&gt;  &lt;NA&gt;
## 3 #003 Brown &amp; Robust Porter     212    2147 0.052  NA            American Porter     12 &lt;NA&gt;  &lt;NA&gt;
## 4        #004 Session I.P.A.     212    2146 0.048  38               American IPA     12 &lt;NA&gt;  &lt;NA&gt;
## 5                         #9     304    1813 0.051  20     Fruit / Vegetable Beer     16 &lt;NA&gt;  &lt;NA&gt;
## 6                         #9     304     360 0.051  20     Fruit / Vegetable Beer     12 &lt;NA&gt;  &lt;NA&gt;</code></pre>
<pre class="r"><code>tail(beermerge,n=6)</code></pre>
<pre><code>##                                  Name Brew_ID Beer_ID ABV IBU Style Ounces            City State
## 2963  Wolverine State Brewing Company     403      NA  NA  NA  &lt;NA&gt;     NA       Ann Arbor    MI
## 2964             Woodchuck Hard Cider     502      NA  NA  NA  &lt;NA&gt;     NA      Middlebury    VT
## 2965 Woodstock Inn, Station &amp; Brewery     110      NA  NA  NA  &lt;NA&gt;     NA North Woodstock    NH
## 2966                 Wormtown Brewery     340      NA  NA  NA  &lt;NA&gt;     NA       Worcester    MA
## 2967           Worthy Brewing Company     200      NA  NA  NA  &lt;NA&gt;     NA            Bend    OR
## 2968          Wynkoop Brewing Company     425      NA  NA  NA  &lt;NA&gt;     NA          Denver    CO</code></pre>
<p>QUESTION 3 The NA values are removed one column at a time The merged dataset contains enough data to allow for them to be removed while still being useful</p>
<pre class="r"><code>statey &lt;- read.csv(&quot;C:/Users/THEBU/Desktop/Doing Data Science/Week 8/statey2.csv&quot;, header = TRUE, na.strings = &quot;NA&quot;)
statey2 &lt;- statey %&gt;% drop_na(IBU)
statey2 &lt;- statey2 %&gt;% drop_na(ABV)</code></pre>
<p>Question 4 Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare I Manually converetd all State NAs to the correct state. #statey &lt;- read.csv(file.choose())</p>
<pre class="r"><code># check to ensure that NAs have been 
colSums(is.na(statey2))</code></pre>
<pre><code>##       X    Name Brew_ID Beer_ID     ABV     IBU   Style  Ounces    City   State 
##       0       0       0       0       0       0       0       0    1402       0</code></pre>
<pre class="r"><code># The process creates two new columns that serve no purpose so they are removed for to ensure the data is tidy.
statey2 &lt;- statey2[,-1,-2]

# Find the median for ABV and IBU by state respectively
# Grouping by State, we can find the median value for ABV and IBU respectively.
mergeAbv &lt;- data.frame(statey2 %&gt;% group_by(State) %&gt;% summarise(ABV_Median = median(ABV)))
mergeIbu &lt;- data.frame(statey2 %&gt;% group_by(State) %&gt;% summarise(IBU_Median = median(IBU)))

# Plot a Bar chart to compare ABV
# The median information can then be used to plot a bar graph using the states as deliminting factors.
stateABV &lt;- ggplot(mergeAbv,aes(fill=State)) +
  geom_bar(stat = &quot;identity&quot;, aes(x= State,y=ABV_Median,color = State ),color = &quot;black&quot;) +
  theme_economist() + 
  scale_color_economist()+
  theme(axis.text.x=element_text(size=rel(1.5), angle=90)) +
  ggtitle(&quot;ABV MEDIAN BASED ON STATE&quot;) +
  labs(x=&quot;State&quot;,y=&quot;ABV MEDIAN&quot;)
# Call the bar graph
stateABV </code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># Plot a Bar chart to compare IBU
stateIBU &lt;- ggplot(mergeIbu,aes(fill=State)) +
  geom_bar(stat = &quot;identity&quot;, aes(x= State,y=IBU_Median,color = State ),color = &quot;black&quot;) +
  theme_economist() + 
  scale_color_economist()+
  theme(axis.text.x=element_text(size=rel(1.5), angle=90)) +
  ggtitle(&quot;IBU MEDIAN BASED ON STATE&quot;) +
  labs(x=&quot;State&quot;,y=&quot;IBU MEDIAN&quot;)
# call the bar graph
stateIBU </code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<p>Question 5 Which state has the maximum alcoholic (ABV) beer? The arrange function is used to list the ABV values in ascending order which easily shows the highest value.</p>
<p>The maximum ABV is held by Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale. This beer is associated with the (Brew_ID 52) # It has an ABV of 0.128. The brewery that makes it is located in Boulder, CO.</p>
<p>The most bitter beer is Bitter Bitch Imperial IPA with (Brew_ID 375). It has an IBU of 138. The brewery which makes this beer is located in Astoria, OR.</p>
<pre class="r"><code>maxabv &lt;- arrange(beermerge,ABV)
maxabv</code></pre>
<pre><code>##                                       Name Brew_ID Beer_ID   ABV IBU                          Style
## 1                              Scotty K NA     523     606 0.001  NA               Low Alcohol Beer
## 2                              Bikini Beer     174    1286 0.027  NA                   American IPA
## 3                           Totally Radler      81    2482 0.027  21                         Radler
## 4                              Summer Brew     110    2306 0.028  15               American Pilsner
## 5                           American Light     130    2231 0.032  13                    Light Lager
## 6                                      Rad      47    2266 0.032   7         Fruit / Vegetable Beer
## 7                              Rocket Girl     529     550 0.032  27                        KÃ¶lsch
## 8                      Weiss Trash Culture     411    1417 0.034   6             Berliner Weissbier
## 9                      Banner American Ale     319    1643 0.035  45       American Amber / Red Ale
## 10            Carolina Blonde Light (2005)     505     782 0.035  NA            American Blonde Ale
## 11                        Drop Dead Blonde     132     684 0.035  NA            American Blonde Ale
## 12                                    Gose      43    2580 0.035  NA                           Gose
## 13                           Montauk Light     250    2024 0.035  NA                    Light Lager
## 14                   Passion Fruit Prussia      61    2545 0.035  11             Berliner Weissbier
## 15         Back in the Saddle Rye Pale Ale     449    1047 0.037  53        American Pale Ale (APA)
## 16                           Gansett Light     144    2345 0.037  10                    Light Lager
## 17           Pace Setter Belgian Style Wit     449    1236 0.037  21                        Witbier
## 18               Pit Stop Chocolate Porter     449    1237 0.037  34                American Porter
## 19                   Chester&#39;s Beer (2005)     513     737 0.038  NA            American Pale Lager
## 20                               Even Keel      35    2105 0.038  40                   American IPA
## 21                                 Pub Ale     246    2033 0.038  18          English Dark Mild Ale
## 22                     Sankaty Light Lager     146     359 0.038  NA                    Light Lager
## 23                         Smooth Operator     163    2307 0.038  NA                      Cream Ale
## 24                      Wolfman&#39;s Berliner     374    1583 0.038  NA             Berliner Weissbier
## 25                         Lawnmower Lager     156     878 0.039  16         American Adjunct Lager
## 26                Monkey Chased the Weasel     223    1941 0.039   9             Berliner Weissbier
## 27                          NOLA Brown Ale     175     485 0.039  NA          English Dark Mild Ale
## 28                         Nonstop Hef Hop      81    2400 0.039  20        American Pale Wheat Ale
## 29                         Nonstop Hef Hop      81    2399 0.039  20        American Pale Wheat Ale
## 30                         Nonstop Hef Hop      81    2398 0.039  20        American Pale Wheat Ale
## 31                         Nonstop Hef Hop      81    2397 0.039  20        American Pale Wheat Ale
## 32                         Nonstop Hef Hop      81    2396 0.039  20        American Pale Wheat Ale
## 33                         Nonstop Hef Hop      81    2395 0.039  20        American Pale Wheat Ale
## 34                         Nonstop Hef Hop      81    2394 0.039  20        American Pale Wheat Ale
## 35                         Nonstop Hef Hop      81    2393 0.039  20        American Pale Wheat Ale
## 36                         Nonstop Hef Hop      81    2392 0.039  20        American Pale Wheat Ale
## 37                         Nonstop Hef Hop      81    2391 0.039  20        American Pale Wheat Ale
## 38                         Nonstop Hef Hop      81    2390 0.039  20        American Pale Wheat Ale
## 39                         Nonstop Hef Hop      81    2389 0.039  20        American Pale Wheat Ale
## 40    77 Fremont Select Spring Session IPA     461    1174 0.040  NA                   American IPA
## 41                           Bitter Brewer      62      19 0.040  37                 English Bitter
## 42                        Blackbeary Wheat     269     574 0.040   8         Fruit / Vegetable Beer
## 43              Carolina Lighthouse (2007)     505     784 0.040  NA            American Blonde Ale
## 44                             Cherny Bock     365     344 0.040  NA                    Schwarzbier
## 45                        Choc Beer (2003)     506     781 0.040   9        American Dark Wheat Ale
## 46                      Cutthroat Pale Ale     160    1088 0.040  34        American Pale Ale (APA)
## 47                        Dead Horse Amber     400     902 0.040  NA        American Pale Wheat Ale
## 48                          Flying Mouse 8      51    2567 0.040  NA                American Porter
## 49                         Greenwood Beach     211    1982 0.040  NA         Fruit / Vegetable Beer
## 50              Hazy Day Belgian-Style Wit     380    1186 0.040  20                        Witbier
## 51                   Johnny&#39;s American IPA     400     644 0.040  NA                   American IPA
## 52                       Knotty Blonde Ale     154    2319 0.040  18            American Blonde Ale
## 53                        Leprechaun Lager     349    1657 0.040  NA            American Pale Lager
## 54                               Lobo Lito     188    2238 0.040  12                    Light Lager
## 55                              Lucky Buck     282    1890 0.040  34                Irish Dry Stout
## 56                     Minhas Light (2012)     135    2358 0.040  NA                    Light Lager
## 57                             Mustang &#39;33     367     862 0.040  NA            American Pale Lager
## 58                           Nomader Weiss     174    2283 0.040  NA             Berliner Weissbier
## 59                      Norm&#39;s Gateway IPA     125    2007 0.040  55                   American IPA
## 60                      Notch Session Pils     272    1190 0.040  NA                 Czech Pilsener
## 61                Organic Baba Black Lager     160    1097 0.040  32                    Schwarzbier
## 62                 Ozark American Pale Ale     260    1961 0.040  39        American Pale Ale (APA)
## 63                          P-Town Pilsner     118    2403 0.040  20               American Pilsner
## 64              Rocket Bike American Lager     400     645 0.040  NA California Common / Steam Beer
## 65                      Session &#39;33 (2011)     367     699 0.040  NA            American Pale Lager
## 66                                Sho&#39;nuff       2    2680 0.040  13               Belgian Pale Ale
## 67      Squatters Full Suspension Pale Ale     303    1826 0.040  NA        American Pale Ale (APA)
## 68      Squatters Full Suspension Pale Ale     303    1679 0.040  NA        American Pale Ale (APA)
## 69              Squeaky Bike Nut Brown Ale     400    1476 0.040  NA             American Brown Ale
## 70                                   SUM&#39;R     160    1212 0.040  17            American Blonde Ale
## 71                      Trader Session IPA     160    1925 0.040  42                   American IPA
## 72                     Wachusett Light IPA     296    1846 0.040  37                   American IPA
## 73              Wachusett Light IPA (2013)     296    1029 0.040  37                   American IPA
## 74              Wasatch Apricot Hefeweizen     303    1681 0.040  NA         Fruit / Vegetable Beer
## 75                          Westbrook Gose     385    1312 0.040   5                           Gose
## 76                     WYLD Extra Pale Ale     160     974 0.040  29        American Pale Ale (APA)
## 77                  Yard Sale Winter Lager     160    2100 0.040  22     American Amber / Red Lager
## 78                          American Amber     130    2232 0.041   8     American Amber / Red Lager
## 79                          American Lager     130    2233 0.041   8         American Adjunct Lager
## 80                        Day Hike Session     191    2235 0.041  41                   American IPA
## 81                             HavanÃ¼ther     391    1526 0.041  NA                    Light Lager
## 82                              Mind Games      11    2465 0.041  NA                   Dunkelweizen
## 83                         Rise to the Top     143    1780 0.041  NA                      Cream Ale
## 84                     Schlafly Hefeweizen     429     588 0.041  16                     Hefeweizen
## 85                                 Sparkle      12    2635 0.041  12            American Pale Lager
## 86  West Portal Colorado Common Summer Ale     221    1422 0.041  NA California Common / Steam Beer
## 87                     312 Urban Wheat Ale      89    2201 0.042  18        American Pale Wheat Ale
## 88                     312 Urban Wheat Ale      89    1829 0.042  18        American Pale Wheat Ale
## 89              312 Urban Wheat Ale (2012)      89     581 0.042  20        American Pale Wheat Ale
## 90                                  A Beer       2    2683 0.042  42        American Pale Ale (APA)
## 91                             Agave Wheat     392    1522 0.042   9        American Pale Wheat Ale
## 92                        Bat Outta Helles      67    2524 0.042  20            Munich Helles Lager
## 93                          Bear Ass Brown     552     212 0.042  NA             American Brown Ale
## 94                       Blood Orange Gose     172    2291 0.042  NA                           Gose
## 95                               Boat Beer     223    1439 0.042  35                   American IPA
## 96                             Boxer Light     135    2275 0.042  NA                    Light Lager
## 97                               BrÃ¼nette     391    1527 0.042  NA                Euro Dark Lager
## 98                               Cream Ale     239    2050 0.042  35                      Cream Ale
## 99                 Farmer&#39;s Daughter Wheat     206    1956 0.042  NA        American Pale Wheat Ale
## 100                   Four Peaks Peach Ale     161    1585 0.042   9         Fruit / Vegetable Beer
## 101                   Golden Trout Pilsner     535      74 0.042  NA                German Pilsener
## 102                    Gossamer Golden Ale     328     149 0.042  NA            American Blonde Ale
## 103                Great Crescent Mild Ale     166     439 0.042  26          English Dark Mild Ale
## 104         High Country Pilsner (Current)     535     511 0.042  NA                German Pilsener
## 105                    Humpback Blonde Ale     204    2184 0.042  22            American Blonde Ale
## 106                           Island Wheat     193     180 0.042  NA        American Pale Wheat Ale
## 107                                 Jammer      47    2479 0.042  16                           Gose
## 108                    Keebarlin&#39; Pale Ale     172    1818 0.042  NA        American Pale Ale (APA)
## 109                            Longhop IPA     282    1891 0.042  30                   American IPA
## 110                         Mexican Logger     265     386 0.042  18            American Pale Lager
## 111                             Monkadelic     190    2236 0.042  NA        American Pale Ale (APA)
##     Ounces City State
## 1       16 &lt;NA&gt;  &lt;NA&gt;
## 2       12 &lt;NA&gt;  &lt;NA&gt;
## 3       16 &lt;NA&gt;  &lt;NA&gt;
## 4       12 &lt;NA&gt;  &lt;NA&gt;
## 5       12 &lt;NA&gt;  &lt;NA&gt;
## 6       16 &lt;NA&gt;  &lt;NA&gt;
## 7       12 &lt;NA&gt;  &lt;NA&gt;
## 8       12 &lt;NA&gt;  &lt;NA&gt;
## 9       12 &lt;NA&gt;  &lt;NA&gt;
## 10      12 &lt;NA&gt;  &lt;NA&gt;
## 11      12 &lt;NA&gt;  &lt;NA&gt;
## 12      16 &lt;NA&gt;  &lt;NA&gt;
## 13      12 &lt;NA&gt;  &lt;NA&gt;
## 14      12 &lt;NA&gt;  &lt;NA&gt;
## 15      12 &lt;NA&gt;  &lt;NA&gt;
## 16      16 &lt;NA&gt;  &lt;NA&gt;
## 17      12 &lt;NA&gt;  &lt;NA&gt;
## 18      12 &lt;NA&gt;  &lt;NA&gt;
## 19      12 &lt;NA&gt;  &lt;NA&gt;
## 20      12 &lt;NA&gt;  &lt;NA&gt;
## 21      12 &lt;NA&gt;  &lt;NA&gt;
## 22      12 &lt;NA&gt;  &lt;NA&gt;
## 23      16 &lt;NA&gt;  &lt;NA&gt;
## 24      12 &lt;NA&gt;  &lt;NA&gt;
## 25      12 &lt;NA&gt;  &lt;NA&gt;
## 26      16 &lt;NA&gt;  &lt;NA&gt;
## 27      12 &lt;NA&gt;  &lt;NA&gt;
## 28      16 &lt;NA&gt;  &lt;NA&gt;
## 29      16 &lt;NA&gt;  &lt;NA&gt;
## 30      16 &lt;NA&gt;  &lt;NA&gt;
## 31      16 &lt;NA&gt;  &lt;NA&gt;
## 32      16 &lt;NA&gt;  &lt;NA&gt;
## 33      16 &lt;NA&gt;  &lt;NA&gt;
## 34      16 &lt;NA&gt;  &lt;NA&gt;
## 35      16 &lt;NA&gt;  &lt;NA&gt;
## 36      16 &lt;NA&gt;  &lt;NA&gt;
## 37      16 &lt;NA&gt;  &lt;NA&gt;
## 38      16 &lt;NA&gt;  &lt;NA&gt;
## 39      16 &lt;NA&gt;  &lt;NA&gt;
## 40      12 &lt;NA&gt;  &lt;NA&gt;
## 41      16 &lt;NA&gt;  &lt;NA&gt;
## 42      12 &lt;NA&gt;  &lt;NA&gt;
## 43      12 &lt;NA&gt;  &lt;NA&gt;
## 44      12 &lt;NA&gt;  &lt;NA&gt;
## 45      12 &lt;NA&gt;  &lt;NA&gt;
## 46      12 &lt;NA&gt;  &lt;NA&gt;
## 47      16 &lt;NA&gt;  &lt;NA&gt;
## 48      12 &lt;NA&gt;  &lt;NA&gt;
## 49      12 &lt;NA&gt;  &lt;NA&gt;
## 50      16 &lt;NA&gt;  &lt;NA&gt;
## 51      16 &lt;NA&gt;  &lt;NA&gt;
## 52      12 &lt;NA&gt;  &lt;NA&gt;
## 53      12 &lt;NA&gt;  &lt;NA&gt;
## 54      12 &lt;NA&gt;  &lt;NA&gt;
## 55      16 &lt;NA&gt;  &lt;NA&gt;
## 56      12 &lt;NA&gt;  &lt;NA&gt;
## 57      12 &lt;NA&gt;  &lt;NA&gt;
## 58      12 &lt;NA&gt;  &lt;NA&gt;
## 59      12 &lt;NA&gt;  &lt;NA&gt;
## 60      12 &lt;NA&gt;  &lt;NA&gt;
## 61      12 &lt;NA&gt;  &lt;NA&gt;
## 62      12 &lt;NA&gt;  &lt;NA&gt;
## 63      12 &lt;NA&gt;  &lt;NA&gt;
## 64      16 &lt;NA&gt;  &lt;NA&gt;
## 65      12 &lt;NA&gt;  &lt;NA&gt;
## 66      16 &lt;NA&gt;  &lt;NA&gt;
## 67      12 &lt;NA&gt;  &lt;NA&gt;
## 68      12 &lt;NA&gt;  &lt;NA&gt;
## 69      16 &lt;NA&gt;  &lt;NA&gt;
## 70      12 &lt;NA&gt;  &lt;NA&gt;
## 71      12 &lt;NA&gt;  &lt;NA&gt;
## 72      12 &lt;NA&gt;  &lt;NA&gt;
## 73      12 &lt;NA&gt;  &lt;NA&gt;
## 74      12 &lt;NA&gt;  &lt;NA&gt;
## 75      12 &lt;NA&gt;  &lt;NA&gt;
## 76      12 &lt;NA&gt;  &lt;NA&gt;
## 77      12 &lt;NA&gt;  &lt;NA&gt;
## 78      12 &lt;NA&gt;  &lt;NA&gt;
## 79      12 &lt;NA&gt;  &lt;NA&gt;
## 80      12 &lt;NA&gt;  &lt;NA&gt;
## 81      16 &lt;NA&gt;  &lt;NA&gt;
## 82      16 &lt;NA&gt;  &lt;NA&gt;
## 83      12 &lt;NA&gt;  &lt;NA&gt;
## 84      12 &lt;NA&gt;  &lt;NA&gt;
## 85      16 &lt;NA&gt;  &lt;NA&gt;
## 86      16 &lt;NA&gt;  &lt;NA&gt;
## 87      16 &lt;NA&gt;  &lt;NA&gt;
## 88      12 &lt;NA&gt;  &lt;NA&gt;
## 89      12 &lt;NA&gt;  &lt;NA&gt;
## 90      16 &lt;NA&gt;  &lt;NA&gt;
## 91      12 &lt;NA&gt;  &lt;NA&gt;
## 92      12 &lt;NA&gt;  &lt;NA&gt;
## 93      12 &lt;NA&gt;  &lt;NA&gt;
## 94      12 &lt;NA&gt;  &lt;NA&gt;
## 95      12 &lt;NA&gt;  &lt;NA&gt;
## 96      12 &lt;NA&gt;  &lt;NA&gt;
## 97      16 &lt;NA&gt;  &lt;NA&gt;
## 98      12 &lt;NA&gt;  &lt;NA&gt;
## 99      12 &lt;NA&gt;  &lt;NA&gt;
## 100     12 &lt;NA&gt;  &lt;NA&gt;
## 101     12 &lt;NA&gt;  &lt;NA&gt;
## 102     16 &lt;NA&gt;  &lt;NA&gt;
## 103     16 &lt;NA&gt;  &lt;NA&gt;
## 104     12 &lt;NA&gt;  &lt;NA&gt;
## 105     12 &lt;NA&gt;  &lt;NA&gt;
## 106     12 &lt;NA&gt;  &lt;NA&gt;
## 107     12 &lt;NA&gt;  &lt;NA&gt;
## 108     12 &lt;NA&gt;  &lt;NA&gt;
## 109     16 &lt;NA&gt;  &lt;NA&gt;
## 110     12 &lt;NA&gt;  &lt;NA&gt;
## 111     12 &lt;NA&gt;  &lt;NA&gt;
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 2857 rows ]</code></pre>
<pre class="r"><code># Which state has the most bitter (IBU) beer?
# The arrange function is used to list the IBU values in ascending order which easily shows the highest value.
mostibu &lt;- arrange(beermerge,IBU)
mostibu</code></pre>
<pre><code>##                                     Name Brew_ID Beer_ID   ABV IBU                      Style Ounces
## 1                        Summer Solstice     172    1350 0.056   4                  Cream Ale     12
## 2                 Summer Solstice (2011)     172      77 0.056   4                  Cream Ale     12
## 3   Summer Solstice Cerveza Crema (2009)     172     753 0.056   4                  Cream Ale     12
## 4                  18th Anniversary Gose     129    2370 0.044   5                       Gose     12
## 5                    Chickawawa Lemonale     366    1604 0.050   5     Fruit / Vegetable Beer     12
## 6          Devils Tramping Ground Tripel     361     704 0.092   5                     Tripel     12
## 7                         Westbrook Gose     385    1312 0.040   5                       Gose     12
## 8                     Yo Soy Un Berliner      67    2520 0.044   5         Berliner Weissbier     12
## 9                           Mr. Blue Sky     125    2375 0.045   6    American Pale Wheat Ale     16
## 10                   Weiss Trash Culture     411    1417 0.034   6         Berliner Weissbier     12
## 11                       Winter Solstice     172     523 0.069   6              Winter Warmer     12
## 12                       O&#39;Fallon Wheach     443     128 0.051   7     Fruit / Vegetable Beer     12
## 13         Point Nude Beach Summer Wheat     132    1225 0.052   7    American Pale Wheat Ale     16
## 14         Point Nude Beach Summer Wheat     132     816 0.050   7    American Pale Wheat Ale     12
## 15  Point Nude Beach Summer Wheat (2010)     132     141 0.050   7    American Pale Wheat Ale     12
## 16  Point Nude Beach Summer Wheat (2011)     132     772 0.050   7    American Pale Wheat Ale     12
## 17                                   Rad      47    2266 0.032   7     Fruit / Vegetable Beer     16
## 18               Samuel Adams Summer Ale     301    1144 0.053   7    American Pale Wheat Ale     12
## 19                             Ale Cider     251    2018 0.065   8     Fruit / Vegetable Beer     16
## 20                        American Amber     130    2232 0.041   8 American Amber / Red Lager     12
## 21                        American Lager     130    2233 0.041   8     American Adjunct Lager     12
## 22               Black Market Hefeweizen     113    1897 0.050   8                 Hefeweizen     12
## 23                      Blackbeary Wheat     269     574 0.040   8     Fruit / Vegetable Beer     12
## 24                             Daft Funk      66    2530 0.043   8         Berliner Weissbier     24
## 25                      Dirty Blonde Ale      73     534 0.045   8        American Blonde Ale     12
## 26                                  Gose      42    2584 0.046   8                       Gose     16
## 27                          Porch Rocker     301    1830 0.045   8                     Radler     12
## 28                           Agave Wheat     392    1522 0.042   9    American Pale Wheat Ale     12
## 29                      Choc Beer (2003)     506     781 0.040   9    American Dark Wheat Ale     12
## 30                  Four Peaks Peach Ale     161    1585 0.042   9     Fruit / Vegetable Beer     12
## 31              Monkey Chased the Weasel     223    1941 0.039   9         Berliner Weissbier     16
## 32                        Onyx Black Ale     132    2151 0.052   9         American Black Ale     12
## 33                         Point Special     132    2365 0.047   9     American Adjunct Lager     12
## 34                         Point Special     132    2228 0.047   9     American Adjunct Lager     12
## 35                  Point Special (2012)     132    2121 0.047   9     American Adjunct Lager     12
## 36                  Point Special (2013)     132    2122 0.047   9     American Adjunct Lager     12
## 37               Point Special (Current)     132    2366 0.047   9     American Adjunct Lager     12
## 38                   Point Special Lager     132    2115 0.047   9     American Adjunct Lager     16
## 39                   Point Special Lager     132     138 0.047   9     American Adjunct Lager     12
## 40                         Two-One Niner     219    1397 0.048   9           American Pilsner     12
## 41                          Beach Blonde     268    1927 0.049  10        American Blonde Ale     16
## 42                    Blood Orange Honey     122    2379 0.057  10     Fruit / Vegetable Beer     16
## 43                          Cotton Mouth     448    1241 0.050  10                    Witbier     12
## 44                        EOS Hefeweizen     338    1147 0.048  10                 Hefeweizen     12
## 45                         Gansett Light     144    2345 0.037  10                Light Lager     16
## 46                          Hotbox Brown      14    2633 0.055  10         American Brown Ale     12
## 47                King Street Hefeweizen     103    1666 0.057  10                 Hefeweizen     12
## 48                             Mo&#39;s Gose     462    1172 0.052  10                       Gose     16
## 49                    Mustang Golden Ale     367     421 0.053  10        American Blonde Ale     12
## 50                               Old Pro      72    2506 0.042  10                       Gose     12
## 51                                PUNK&#39;N     160    2310 0.050  10                Pumpkin Ale     12
## 52                               Rye Wit      67    2522 0.042  10                    Witbier     12
## 53                 Sweet Yamma Jamma Ale     278    1555 0.050  10     Fruit / Vegetable Beer     12
## 54                             UFO White     235     610 0.048  10    American Pale Wheat Ale     12
## 55               Wachusett Blueberry Ale     296     619 0.045  10     Fruit / Vegetable Beer     12
## 56                        Watermelon Ale     104    2435 0.050  10     Fruit / Vegetable Beer     12
## 57                          White Rascal      38     108 0.056  10                    Witbier     12
## 58                        Widespread Wit     366     865 0.055  10                    Witbier     16
## 59                                Apollo      47     630 0.052  11    American Pale Wheat Ale     16
## 60                      Blackberry Wheat      88    2459 0.048  11    American Pale Wheat Ale     16
## 61                 Cold Smoke Scotch Ale     511      85 0.065  11     Scotch Ale / Wee Heavy     16
## 62          Cold Smoke Scotch Ale (2007)     511     760 0.065  11     Scotch Ale / Wee Heavy     16
## 63                        El Hefe Speaks     228    1263 0.053  11                 Hefeweizen     12
## 64                                  LIFT      92    1816 0.047  11                    KÃ¶lsch     12
## 65                 Oval Beach Blonde Ale     399    1477 0.050  11        American Blonde Ale     16
## 66                 Passion Fruit Prussia      61    2545 0.035  11         Berliner Weissbier     12
## 67                Rhode Island Blueberry     102    2438 0.046  11                    KÃ¶lsch     12
## 68                      Royal Weisse Ale     372      22 0.056  11                 Hefeweizen     12
## 69                            Shark Bait     394    1508 0.053  11     Fruit / Vegetable Beer     12
## 70                         Shotgun Betty     150    2327 0.058  11                 Hefeweizen     12
## 71                        Vanilla Porter      40    2587 0.070  11            American Porter     16
## 72                        Watermelon Ale     109    2421 0.051  11     Fruit / Vegetable Beer     12
## 73                       Wick For Brains     338    1705 0.061  11                Pumpkin Ale     12
## 74                       Atwater&#39;s Lager      73     527 0.050  12        Munich Helles Lager     12
## 75                  Blueberry Blonde Ale     300     773 0.050  12        American Blonde Ale     12
## 76                         Broken Bridge     216    2117 0.056  12               Dunkelweizen     12
## 77                Damascene Apricot Sour      18    2622 0.052  12     Fruit / Vegetable Beer     16
## 78                   Dry Dock Hefeweizen     497     872 0.043  12                 Hefeweizen     12
## 79                                Festie     384     369 0.048  12      MÃ¤rzen / Oktoberfest     12
## 80                  Full Boar Scotch Ale     492     647 0.074  12     Scotch Ale / Wee Heavy     16
## 81                     Here Gose Nothin&#39;      58    2021 0.050  12                       Gose     12
## 82                      La Perouse White     376     547 0.050  12                    Witbier     12
## 83                Laughing Dog Cream Ale     219    2108 0.050  12                  Cream Ale     12
## 84                             Lobo Lito     188    2238 0.040  12                Light Lager     12
## 85                    Snowshoe White Ale     224     587 0.048  12                    Witbier     12
## 86                               Sparkle      12    2635 0.041  12        American Pale Lager     16
## 87                     Tallgrass Pub Ale      46    1009 0.044  12         American Brown Ale     16
## 88                   Vanilla Java Porter      73    2502 0.055  12            American Porter     16
## 89                     Woolybugger Wheat     310    1150 0.046  12    American Pale Wheat Ale     12
## 90                    541 American Lager     199    1354 0.048  13        American Pale Lager     12
## 91                        American Light     130    2231 0.032  13                Light Lager     12
## 92            Barney Flats Oatmeal Stout     172    1520 0.057  13              Oatmeal Stout     12
## 93            Barney Flats Oatmeal Stout     172    1221 0.057  13              Oatmeal Stout     12
## 94     Barney Flats Oatmeal Stout (2012)     172     572 0.057  13              Oatmeal Stout     12
## 95                           Elder Betty     304    1113 0.055  13                 Hefeweizen     12
## 96      Great Crescent Belgian Style Wit     166     478 0.051  13                    Witbier     16
## 97                           Purple Haze     534     515 0.042  13     Fruit / Vegetable Beer     12
## 98                              Sho&#39;nuff       2    2680 0.040  13           Belgian Pale Ale     16
## 99                       Three Kings Ale     132     650 0.049  13                    KÃ¶lsch     12
## 100                     Wheat the People     419     893 0.044  13    American Pale Wheat Ale     16
## 101                Wild Onion Summer Wit     362     398 0.042  13                    Witbier     12
## 102                Bottom Up Belgian Wit      45     414 0.050  14                    Witbier     12
## 103                   Couch Select Lager     198    2196 0.050  14        American Pale Lager     12
## 104               Hangar 24 Helles Lager     477    1015 0.043  14        Munich Helles Lager     12
## 105                          Honey Wheat     327    1052 0.047  14    American Pale Wheat Ale     12
## 106         Morning Wood Wheat (Current)     136    2360 0.059  14    American Pale Wheat Ale     12
## 107         Morning Wood Wheat (Current)     136     130 0.059  14    American Pale Wheat Ale     12
## 108                  Point Amber Classic     132     139 0.047  14 American Amber / Red Lager     12
## 109                     Schuylkill Punch     357    1355 0.060  14     Fruit / Vegetable Beer     12
## 110                        Washita Wheat     367     420 0.053  14    American Pale Wheat Ale     12
## 111                     A Slice of Hefen     333    1741 0.054  15                 Hefeweizen     16
##     City State
## 1   &lt;NA&gt;  &lt;NA&gt;
## 2   &lt;NA&gt;  &lt;NA&gt;
## 3   &lt;NA&gt;  &lt;NA&gt;
## 4   &lt;NA&gt;  &lt;NA&gt;
## 5   &lt;NA&gt;  &lt;NA&gt;
## 6   &lt;NA&gt;  &lt;NA&gt;
## 7   &lt;NA&gt;  &lt;NA&gt;
## 8   &lt;NA&gt;  &lt;NA&gt;
## 9   &lt;NA&gt;  &lt;NA&gt;
## 10  &lt;NA&gt;  &lt;NA&gt;
## 11  &lt;NA&gt;  &lt;NA&gt;
## 12  &lt;NA&gt;  &lt;NA&gt;
## 13  &lt;NA&gt;  &lt;NA&gt;
## 14  &lt;NA&gt;  &lt;NA&gt;
## 15  &lt;NA&gt;  &lt;NA&gt;
## 16  &lt;NA&gt;  &lt;NA&gt;
## 17  &lt;NA&gt;  &lt;NA&gt;
## 18  &lt;NA&gt;  &lt;NA&gt;
## 19  &lt;NA&gt;  &lt;NA&gt;
## 20  &lt;NA&gt;  &lt;NA&gt;
## 21  &lt;NA&gt;  &lt;NA&gt;
## 22  &lt;NA&gt;  &lt;NA&gt;
## 23  &lt;NA&gt;  &lt;NA&gt;
## 24  &lt;NA&gt;  &lt;NA&gt;
## 25  &lt;NA&gt;  &lt;NA&gt;
## 26  &lt;NA&gt;  &lt;NA&gt;
## 27  &lt;NA&gt;  &lt;NA&gt;
## 28  &lt;NA&gt;  &lt;NA&gt;
## 29  &lt;NA&gt;  &lt;NA&gt;
## 30  &lt;NA&gt;  &lt;NA&gt;
## 31  &lt;NA&gt;  &lt;NA&gt;
## 32  &lt;NA&gt;  &lt;NA&gt;
## 33  &lt;NA&gt;  &lt;NA&gt;
## 34  &lt;NA&gt;  &lt;NA&gt;
## 35  &lt;NA&gt;  &lt;NA&gt;
## 36  &lt;NA&gt;  &lt;NA&gt;
## 37  &lt;NA&gt;  &lt;NA&gt;
## 38  &lt;NA&gt;  &lt;NA&gt;
## 39  &lt;NA&gt;  &lt;NA&gt;
## 40  &lt;NA&gt;  &lt;NA&gt;
## 41  &lt;NA&gt;  &lt;NA&gt;
## 42  &lt;NA&gt;  &lt;NA&gt;
## 43  &lt;NA&gt;  &lt;NA&gt;
## 44  &lt;NA&gt;  &lt;NA&gt;
## 45  &lt;NA&gt;  &lt;NA&gt;
## 46  &lt;NA&gt;  &lt;NA&gt;
## 47  &lt;NA&gt;  &lt;NA&gt;
## 48  &lt;NA&gt;  &lt;NA&gt;
## 49  &lt;NA&gt;  &lt;NA&gt;
## 50  &lt;NA&gt;  &lt;NA&gt;
## 51  &lt;NA&gt;  &lt;NA&gt;
## 52  &lt;NA&gt;  &lt;NA&gt;
## 53  &lt;NA&gt;  &lt;NA&gt;
## 54  &lt;NA&gt;  &lt;NA&gt;
## 55  &lt;NA&gt;  &lt;NA&gt;
## 56  &lt;NA&gt;  &lt;NA&gt;
## 57  &lt;NA&gt;  &lt;NA&gt;
## 58  &lt;NA&gt;  &lt;NA&gt;
## 59  &lt;NA&gt;  &lt;NA&gt;
## 60  &lt;NA&gt;  &lt;NA&gt;
## 61  &lt;NA&gt;  &lt;NA&gt;
## 62  &lt;NA&gt;  &lt;NA&gt;
## 63  &lt;NA&gt;  &lt;NA&gt;
## 64  &lt;NA&gt;  &lt;NA&gt;
## 65  &lt;NA&gt;  &lt;NA&gt;
## 66  &lt;NA&gt;  &lt;NA&gt;
## 67  &lt;NA&gt;  &lt;NA&gt;
## 68  &lt;NA&gt;  &lt;NA&gt;
## 69  &lt;NA&gt;  &lt;NA&gt;
## 70  &lt;NA&gt;  &lt;NA&gt;
## 71  &lt;NA&gt;  &lt;NA&gt;
## 72  &lt;NA&gt;  &lt;NA&gt;
## 73  &lt;NA&gt;  &lt;NA&gt;
## 74  &lt;NA&gt;  &lt;NA&gt;
## 75  &lt;NA&gt;  &lt;NA&gt;
## 76  &lt;NA&gt;  &lt;NA&gt;
## 77  &lt;NA&gt;  &lt;NA&gt;
## 78  &lt;NA&gt;  &lt;NA&gt;
## 79  &lt;NA&gt;  &lt;NA&gt;
## 80  &lt;NA&gt;  &lt;NA&gt;
## 81  &lt;NA&gt;  &lt;NA&gt;
## 82  &lt;NA&gt;  &lt;NA&gt;
## 83  &lt;NA&gt;  &lt;NA&gt;
## 84  &lt;NA&gt;  &lt;NA&gt;
## 85  &lt;NA&gt;  &lt;NA&gt;
## 86  &lt;NA&gt;  &lt;NA&gt;
## 87  &lt;NA&gt;  &lt;NA&gt;
## 88  &lt;NA&gt;  &lt;NA&gt;
## 89  &lt;NA&gt;  &lt;NA&gt;
## 90  &lt;NA&gt;  &lt;NA&gt;
## 91  &lt;NA&gt;  &lt;NA&gt;
## 92  &lt;NA&gt;  &lt;NA&gt;
## 93  &lt;NA&gt;  &lt;NA&gt;
## 94  &lt;NA&gt;  &lt;NA&gt;
## 95  &lt;NA&gt;  &lt;NA&gt;
## 96  &lt;NA&gt;  &lt;NA&gt;
## 97  &lt;NA&gt;  &lt;NA&gt;
## 98  &lt;NA&gt;  &lt;NA&gt;
## 99  &lt;NA&gt;  &lt;NA&gt;
## 100 &lt;NA&gt;  &lt;NA&gt;
## 101 &lt;NA&gt;  &lt;NA&gt;
## 102 &lt;NA&gt;  &lt;NA&gt;
## 103 &lt;NA&gt;  &lt;NA&gt;
## 104 &lt;NA&gt;  &lt;NA&gt;
## 105 &lt;NA&gt;  &lt;NA&gt;
## 106 &lt;NA&gt;  &lt;NA&gt;
## 107 &lt;NA&gt;  &lt;NA&gt;
## 108 &lt;NA&gt;  &lt;NA&gt;
## 109 &lt;NA&gt;  &lt;NA&gt;
## 110 &lt;NA&gt;  &lt;NA&gt;
## 111 &lt;NA&gt;  &lt;NA&gt;
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 2857 rows ]</code></pre>
<p>Question 6 Comment on the summary statistics and distribution of the ABV variable.</p>
<p>The summary function prints a list of useful data points in a very brief fashion for gathering relevant facts about vectors in # this case. Using summary I am able to confirm that 128 is th max ABV.</p>
<pre class="r"><code>summary(beermerge$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##  0.0010  0.0500  0.0560  0.0598  0.0670  0.1280     620</code></pre>
<pre class="r"><code>#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
# 0.0010  0.0500  0.0560  0.0598  0.0670  0.1280     620 
summary(statey2$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.02700 0.05000 0.05700 0.05991 0.06800 0.12500</code></pre>
<pre class="r"><code>#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 0.02700 0.05000 0.05700 0.05991 0.06800 0.12500</code></pre>
<p>Question 7 Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. Make your best judgment # of a relationship and EXPLAIN your answer.</p>
<p>The scatter plot shows a similarity between ABV and IBU. As ABV increases IBU does as well. This increase appears to be coincidental as there is a linear correlation but it is not entirely consitent The correlation is visible but there are a significant amount of instances in which the IBU may be high but ABV is not and vice versa.</p>
<p>Using the Pearson Correlation to measure the linear correlation between ABV and IBU The correlation is shown to be at 0.67.</p>
<pre class="r"><code>related &lt;- ggplot(statey2, aes(x=ABV, y= IBU)) +
  geom_point(shape=18) +
  geom_smooth() +
  ggtitle(&quot;Is there a correlation between IBU and ABV?&quot;) +
  labs(x=&quot;ABV&quot;,y=&quot;IBU&quot;) +
  theme_economist() + 
  scale_color_economist()+
  theme(axis.text.x=element_text(size=rel(1.5))) +
  theme(axis.text.y=element_text(size=rel(1.5)))
related</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>pairs.panels(statey2[6:7], gap=0)</code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Question 8 Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA)</p>
<pre class="r"><code># Filter out any beer style that isnt and IPA or an Ale.
IPAandALE &lt;- filter(statey2,grepl(&#39;IPA|Ale&#39;,Style))
IPAandALE &lt;- IPAandALE[,-8]
# Create a new dataframe that only holds the ABV,IBU, and beer style.
IPAandALEslim &lt;- select(IPAandALE,ABV,IBU,Style)
IPAandALEslim$Style &lt;- as.character(IPAandALEslim$Style)

# Normalize the Beer styles to IPA or ALE
# This loop is used to iterate through each row and then to normalize the styles to simply say IPA or Ale.

for (i in 1:944) {
  if (is.na(str_match(IPAandALEslim[i,3],&quot;.Ale&quot;))) {
    IPAandALEslim[i,3] &lt;- &quot;IPA&quot;
  } else {
    IPAandALEslim[i,3] &lt;- &quot;ALE&quot; 
    
  }
}</code></pre>
<p>use KNN classification to investigate this relationship Provide statistical evidence. your audience is comfortable with percentages.</p>
<pre class="r"><code># Select a random seed value
# A split of 70% to 30% will work with this dataset to create a useful training and test set.
set.seed(1234)
splitpale = .70
ipasamp &lt;- sample(1:dim(IPAandALEslim)[1],round(splitpale * dim(IPAandALEslim)[1]))
# ipasamp

# The following code separates the randomly selected values into the 70 to 30 split.
trainIpa &lt;- IPAandALEslim[ipasamp,]
testIpa &lt;- IPAandALEslim[-ipasamp,]

# Using only the IBU and ABV values from both the training and test sets
# I use the beer style as the class against which the knn will search.
knnipa &lt;- knn(trainIpa[,1:2],testIpa[,1:2],cl=trainIpa$Style,k=14,prob = TRUE)
# The confusion matrix is used for calibrating the output of a model and examining all possible outcomes of the predictions
ipamatrix &lt;- confusionMatrix(table(knnipa,testIpa$Style))
ipamatrix</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##       
## knnipa ALE IPA
##    ALE 150  31
##    IPA  13  89
##                                          
##                Accuracy : 0.8445         
##                  95% CI : (0.797, 0.8847)
##     No Information Rate : 0.576          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16        
##                                          
##                   Kappa : 0.6753         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.01038        
##                                          
##             Sensitivity : 0.9202         
##             Specificity : 0.7417         
##          Pos Pred Value : 0.8287         
##          Neg Pred Value : 0.8725         
##              Prevalence : 0.5760         
##          Detection Rate : 0.5300         
##    Detection Prevalence : 0.6396         
##       Balanced Accuracy : 0.8310         
##                                          
##        &#39;Positive&#39; Class : ALE            
## </code></pre>
<pre class="r"><code># The below code will iterate through 100 values of k in order to hypertune the k parameter.
# This is done to identify the best K value to increase the accuracy percentage
accu = data.frame(accuracy = numeric(100), k = numeric(100))
for (i in 1:100) {
  classify = knn(trainIpa[,c(1,2)],testIpa[,c(1,2)],trainIpa$Style, prob = TRUE, k = i)
  table(classify,testIpa$Style)
  confused &lt;- confusionMatrix(table(classify,testIpa$Style))
  accu$accuracy[i] = confused$overall[1]
  accu$k[i] = i
}

accuplot &lt;- ggplot(accu,aes(x=k,y=accuracy)) +
  geom_line() +
  labs(x=&quot;Tally&quot;,y=&quot;Accuracy&quot;)
accuplot &lt;- ggplotly(accuplot)

accuplot</code></pre>
<div id="htmlwidget-b06988bc478680ad369e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b06988bc478680ad369e">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.830388692579505,0.812720848056537,0.840989399293286,0.855123674911661,0.858657243816254,0.855123674911661,0.848056537102474,0.84452296819788,0.851590106007067,0.855123674911661,0.851590106007067,0.851590106007067,0.848056537102474,0.848056537102474,0.840989399293286,0.840989399293286,0.840989399293286,0.837455830388693,0.851590106007067,0.84452296819788,0.837455830388693,0.840989399293286,0.840989399293286,0.848056537102474,0.848056537102474,0.84452296819788,0.84452296819788,0.848056537102474,0.84452296819788,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.848056537102474,0.837455830388693,0.840989399293286,0.84452296819788,0.84452296819788,0.837455830388693,0.837455830388693,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286,0.840989399293286],"text":["k:   1<br />accuracy: 0.8303887","k:   2<br />accuracy: 0.8127208","k:   3<br />accuracy: 0.8409894","k:   4<br />accuracy: 0.8551237","k:   5<br />accuracy: 0.8586572","k:   6<br />accuracy: 0.8551237","k:   7<br />accuracy: 0.8480565","k:   8<br />accuracy: 0.8445230","k:   9<br />accuracy: 0.8515901","k:  10<br />accuracy: 0.8551237","k:  11<br />accuracy: 0.8515901","k:  12<br />accuracy: 0.8515901","k:  13<br />accuracy: 0.8480565","k:  14<br />accuracy: 0.8480565","k:  15<br />accuracy: 0.8409894","k:  16<br />accuracy: 0.8409894","k:  17<br />accuracy: 0.8409894","k:  18<br />accuracy: 0.8374558","k:  19<br />accuracy: 0.8515901","k:  20<br />accuracy: 0.8445230","k:  21<br />accuracy: 0.8374558","k:  22<br />accuracy: 0.8409894","k:  23<br />accuracy: 0.8409894","k:  24<br />accuracy: 0.8480565","k:  25<br />accuracy: 0.8480565","k:  26<br />accuracy: 0.8445230","k:  27<br />accuracy: 0.8445230","k:  28<br />accuracy: 0.8480565","k:  29<br />accuracy: 0.8445230","k:  30<br />accuracy: 0.8480565","k:  31<br />accuracy: 0.8480565","k:  32<br />accuracy: 0.8480565","k:  33<br />accuracy: 0.8480565","k:  34<br />accuracy: 0.8480565","k:  35<br />accuracy: 0.8480565","k:  36<br />accuracy: 0.8480565","k:  37<br />accuracy: 0.8480565","k:  38<br />accuracy: 0.8480565","k:  39<br />accuracy: 0.8480565","k:  40<br />accuracy: 0.8480565","k:  41<br />accuracy: 0.8480565","k:  42<br />accuracy: 0.8480565","k:  43<br />accuracy: 0.8480565","k:  44<br />accuracy: 0.8480565","k:  45<br />accuracy: 0.8480565","k:  46<br />accuracy: 0.8480565","k:  47<br />accuracy: 0.8480565","k:  48<br />accuracy: 0.8480565","k:  49<br />accuracy: 0.8480565","k:  50<br />accuracy: 0.8480565","k:  51<br />accuracy: 0.8480565","k:  52<br />accuracy: 0.8480565","k:  53<br />accuracy: 0.8480565","k:  54<br />accuracy: 0.8480565","k:  55<br />accuracy: 0.8480565","k:  56<br />accuracy: 0.8480565","k:  57<br />accuracy: 0.8480565","k:  58<br />accuracy: 0.8480565","k:  59<br />accuracy: 0.8480565","k:  60<br />accuracy: 0.8480565","k:  61<br />accuracy: 0.8480565","k:  62<br />accuracy: 0.8480565","k:  63<br />accuracy: 0.8480565","k:  64<br />accuracy: 0.8480565","k:  65<br />accuracy: 0.8480565","k:  66<br />accuracy: 0.8480565","k:  67<br />accuracy: 0.8480565","k:  68<br />accuracy: 0.8480565","k:  69<br />accuracy: 0.8480565","k:  70<br />accuracy: 0.8480565","k:  71<br />accuracy: 0.8480565","k:  72<br />accuracy: 0.8480565","k:  73<br />accuracy: 0.8480565","k:  74<br />accuracy: 0.8480565","k:  75<br />accuracy: 0.8480565","k:  76<br />accuracy: 0.8480565","k:  77<br />accuracy: 0.8480565","k:  78<br />accuracy: 0.8480565","k:  79<br />accuracy: 0.8480565","k:  80<br />accuracy: 0.8480565","k:  81<br />accuracy: 0.8480565","k:  82<br />accuracy: 0.8480565","k:  83<br />accuracy: 0.8374558","k:  84<br />accuracy: 0.8409894","k:  85<br />accuracy: 0.8445230","k:  86<br />accuracy: 0.8445230","k:  87<br />accuracy: 0.8374558","k:  88<br />accuracy: 0.8374558","k:  89<br />accuracy: 0.8409894","k:  90<br />accuracy: 0.8409894","k:  91<br />accuracy: 0.8409894","k:  92<br />accuracy: 0.8409894","k:  93<br />accuracy: 0.8409894","k:  94<br />accuracy: 0.8409894","k:  95<br />accuracy: 0.8409894","k:  96<br />accuracy: 0.8409894","k:  97<br />accuracy: 0.8409894","k:  98<br />accuracy: 0.8409894","k:  99<br />accuracy: 0.8409894","k: 100<br />accuracy: 0.8409894"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.95,104.95],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[-4.44089209850063e-016,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Tally","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.810424028268551,0.86095406360424],"tickmode":"array","ticktext":["0.82","0.83","0.84","0.85","0.86"],"tickvals":[0.82,0.83,0.84,0.85,0.86],"categoryorder":"array","categoryarray":["0.82","0.83","0.84","0.85","0.86"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Accuracy","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"6ac285a5d96":{"x":{},"y":{},"type":"scatter"}},"cur_data":"6ac285a5d96","visdat":{"6ac285a5d96":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># 14 seems to yield the best accuracy</code></pre>
<p>In addition,to KNN, I will use NaiveBayes to supplement the response to question of ABV and IBU correlation in IPAs and Ales. Using NaiveBayes, re-evalute the IPA and Ale data based on IBU and ABV.</p>
<pre class="r"><code># Values are set to factor types.
IPAandALEslim$Style &lt;- as.factor(IPAandALEslim$Style)
testIpa$Style &lt;- as.factor(testIpa$Style)
trainIpa$Style &lt;- as.factor(trainIpa$Style)

# The model is created using the training data and the Naive Bayes function.
modelipa &lt;- naiveBayes(Style ~., data = trainIpa)
modelipa</code></pre>
<pre><code>## 
## Naive Bayes Classifier for Discrete Predictors
## 
## Call:
## naiveBayes.default(x = X, y = Y, laplace = laplace)
## 
## A-priori probabilities:
## Y
##       ALE       IPA 
## 0.5990923 0.4009077 
## 
## Conditional probabilities:
##      ABV
## Y           [,1]       [,2]
##   ALE 0.05637626 0.01165506
##   IPA 0.06909057 0.01238949
## 
##      IBU
## Y         [,1]     [,2]
##   ALE 34.36364 18.47103
##   IPA 72.69811 20.12855</code></pre>
<pre class="r"><code># A separate dataframe is used to predict agianst with our model. The new dataframe is set to only IPA styles.
df1 &lt;- data.frame(Style = &quot;IPA&quot;,ABV = testIpa$ABV, IBU = testIpa$IBU)
pipa &lt;- predict(modelipa,df1)
#p &lt;- #as.factor(p)

# Creating a table shows the results of our prediction and compares them to the known truth of the style values.
# It clearly shows the probability that a beer is an IPA or ALe using IBU and ABV values to decide.
tableALE &lt;- table(pipa,testIpa$Style)
confuseale &lt;- confusionMatrix(tableALE)
confuseale</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
## pipa  ALE IPA
##   ALE 146  23
##   IPA  17  97
##                                           
##                Accuracy : 0.8587          
##                  95% CI : (0.8125, 0.8971)
##     No Information Rate : 0.576           
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.7087          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.4292          
##                                           
##             Sensitivity : 0.8957          
##             Specificity : 0.8083          
##          Pos Pred Value : 0.8639          
##          Neg Pred Value : 0.8509          
##              Prevalence : 0.5760          
##          Detection Rate : 0.5159          
##    Detection Prevalence : 0.5972          
##       Balanced Accuracy : 0.8520          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<pre class="r"><code>table &lt;- data.frame(confusionMatrix(pipa, testIpa$Style)$table)
plotTable &lt;- table %&gt;%
  mutate(goodbad = ifelse(table$Prediction == table$Reference, &quot;good&quot;, &quot;bad&quot;)) %&gt;%
  group_by(Reference) %&gt;%
  mutate(prop = Freq/sum(Freq))

# fill alpha relative to sensitivity/specificity by proportional outcomes within reference groups (see dplyr code above as well as original confusion matrix for comparison)
ipatable &lt;- ggplot(data = plotTable, mapping = aes(x = Reference, y = Prediction, fill = goodbad, alpha = prop)) +
  geom_tile() +
  geom_text(aes(label = Freq), vjust = .5, fontface  = &quot;bold&quot;, alpha = 1) +
  scale_fill_manual(values = c(good = &quot;green&quot;, bad = &quot;red&quot;)) +
  theme_bw() +
  xlim(rev(levels(table$Reference)))
ipatable</code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-13-1.png" width="672" /> Question 9 Find one other useful inference from the data that you feel Budweiser may be able to find value in. You must convince them why # it is important and back up your conviction with appropriate statistical evidence</p>
<p>Create a bubble chart showing which states tend to prefer larger bottles of beer with higher ABV for marketing purposes. This information is useful in that it can be used to target the beer consumers based on their consumption habits and location. By visualizing the Ounces of beer bottles and cross referencing this data with ABV we are able to see a pattern. The pattern can then be layed over states to show which states may act as the largest consumers of beer products. Large, lighter blue circles that sit higher on the graph show large, high alcohol content consumption. By tracing the line down from such circles, you can see which state these trends exist in.</p>
<pre class="r"><code>theme_set(theme_bw())  
g &lt;- ggplot(statey2, aes(State, ABV,color=Ounces))
market&lt;- g + geom_count(show.legend=F) +
  labs(subtitle=&quot;Correlate high ABV and large containers for marketing&quot;, 
       y=&quot;ABV&quot;, 
       x=&quot;State&quot;, 
       title=&quot;Large container consumption by State&quot;)

market</code></pre>
<p><img src="Wilds_Ivory_Presentation_1_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>                                            Conclusion</code></pre>
<p>In summary, the United States has a large and thriving collection of breweries scattered throughout the states. Their are some states where breweries are very prominent. In contrast there are States where there may be only a single brewery. All of the information listed above can be used to increase the sale of beer products. It can also be used to increase the current level of efficiency relted to beer production. For instance, states that already have a high number of breweries may or may not be prime candidates for larger shipments of domestic beer from neighboring States.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
